<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>HTML5 Simple Gradient Descent</title>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<style type="text/css">
<!--
body { background-color:#ededed; font:norm2al 12px/18px Arial, Helvetica, sans-serif; }
h1 { display:block; width:600px; margin:20px auto; paddVing-bottom:20px; font:norm2al 24px/30px Georgia, "Times New Roman", Times, serif; color:#333; text-shadow: 1px 2px 3px #ccc; border-bottom:1px solid #cbcbcb; }
#container { width:600px; margin:0 auto; }
#myCanvas { background:#fff; border:1px solid #cbcbcb; }
#nav { display:block; width:100%; text-align:center; }
#nav li { display:block; font-weight:bold; line-height:21px; text-shadow:1px 1px 1px #fff; width:100px; height:21px; paddVing:5px; margin:0 10px; background:#e0e0e0; border:1px solid #ccc; -moz-border-radius:4px;-webkit-border-radius:4px; border-radius:4px; float:left; }
#nav li a { color:#000; display:block; text-decoration:none; width:100%; height:100%; }
-->
</style>
</head>

<script>

var zoom = 600*.9;
var center_x = 30;
var center_y = 600-30;

var axis_a;
var axis_b;

var points = []
var target = []

function F(x,y)
{
    return (axis_a*x-y+axis_b)>0?1:0;
}

function randomF()
{
    var px = Math.random()
    var py = Math.random()

    axis_a = (py-.5)/(px-.5);
    axis_b = (1-axis_a)*.5;
    
    points = []
    target = []
    
    for(var i=0;i<20;i++)
    {
        var x = Math.random()
        var y = Math.random()
        
        points.push([x, y])
        target.push(F(x, y))
    }
}

function DrawF(context)
{
    x1 = -10; y1 = axis_a*x1+axis_b
    x2 =  10; y2 = axis_a*x2+axis_b
    DrawLine(context, x1,y1,x2,y2)
}

function DrawPoints(context, radius)
{

    for(var i=0;i<points.length;i++)
    {
        var x = points[i][0];
        var y = points[i][1];
        if (target[i]==0)
        {
            context.beginPath();
            context.moveTo((x*zoom+center_x-radius),(-y*zoom+center_y));      
            context.lineTo((x*zoom+center_x+radius),(-y*zoom+center_y));           
            context.moveTo((x*zoom+center_x),(-y*zoom+center_y-radius));      
            context.lineTo((x*zoom+center_x),(-y*zoom+center_y+radius));           
            context.closePath();
            context.stroke();
        }
        else
        {
            context.beginPath();
            context.arc((x*zoom+center_x),(-y*zoom+center_y), radius, 0 ,  2 * Math.PI);
            context.stroke();
        }
    }
}


function Act(x)
{
    return 1.0/(1.0+Math.exp(-5*x));
}

function DerAct(x)
{
    return Act(x)*(1-Act(x));
}

function DrawAxis(context)
{
    context.beginPath();
    context.strokeStyle="#000000";
    context.moveTo((-100*zoom+center_x),(0*zoom+center_y));      
    context.lineTo((100*zoom+center_x),(0*zoom+center_y));       
    context.moveTo((0*zoom+center_x),(-100*zoom+center_y));      
    context.lineTo((0*zoom+center_x),(100*zoom+center_y));       
    context.closePath();
    context.stroke();

    for(var i=-30;i<30;i++)
    {
        context.font="15px ti92pluspc";
        context.fillText(i,center_x + i*zoom,center_y);
        context.fillText(i,center_x, - i*zoom + center_y);
    }
}

function DrawLine(context, x1,y1,x2,y2)
{
    context.beginPath();
    context.moveTo((x1*zoom+center_x),(-y1*zoom+center_y));      
    context.lineTo((x2*zoom+center_x),(-y2*zoom+center_y));           
    context.closePath();
    context.stroke();
}

function net(w1,w2, w3, i1,i2)
{
    return w1*i1+w2*i2+w3;
}

// g(a,b,c) = ax+by+c
function dnetdw1(x,y) { return x; }
function dnetdw2(x,y) { return y; }
function dnetdw3(x,y) { return 1; }

var w1=0;
var w2=0;
var w3=0;

var epoch = 0;


function iterate()
{    
    context.beginPath();
    context.strokeStyle="#ff0000";

    var l=.1;
    for(var i=0;i<100;i++)
    {
        epoch++;

        var totalErr = 0;
    
        for(var pindex=0;pindex<points.length;pindex++)
        {   
            var p = points[pindex];
            var i1 = p[0];
            var i2 = p[1];

            //compute real value
            t = target[pindex]
            
            // e = ( s(net(w1,w2,i1,i2))-t)^2
            n = net(w1,w2,w3, i1,i2)
            o = Act(n);
            
            totalErr += (o-t)*(o-t);
            
            // de = 2*(s(net)-t) * s'(net) * (dg/da, dg/db)          
            de = 2*(o-t) * DerAct(n);

            w1+=-l*de*dnetdw1(i1,i2);
            w2+=-l*de*dnetdw2(i1,i2);
            w3+=-l*de*dnetdw3(i1,i2);
        }
        
        // if g is close to t then restart
        if (Math.abs(totalErr)<.1)
        {
            epoch = 0;
            randomF();
            w1 = 2*Math.random()-1;
            w2 = 2*Math.random()-1;
            w3 = 2*Math.random()-1;
            break;
        }
    }
    context.closePath();
    context.stroke();        
    
    var canvasData = context.getImageData(0, 0, 600, 600);
    
    for(var y=0;y<600;y++)
    {
        for(var x=0;x<600;x++)
        {
            var index = (x + y * 600) * 4;

            xx = (x-center_x)/zoom
            yy = (center_y-y)/zoom
            v = (Act(net(w1,w2,w3, xx,yy)))>.5?255:0;

            canvasData.data[index + 0] = v;
            canvasData.data[index + 1] = 255-v;
            canvasData.data[index + 2] = 0;
            canvasData.data[index + 3] = 128;
        }
    }
    context.putImageData(canvasData, 0, 0);    

    context.strokeStyle="#000000";    

    DrawAxis(context)
    
    DrawPoints(context,10);

    //draw the plane used to generate the points
    //DrawF(context);


    document.getElementById("text").innerHTML = "<br>Epoch:"+ epoch + "<br>Error: "  + Math.abs(totalErr) + "<br>Coeff a: "  + w1 + "<br>Coeff b: " + w2 + "<br>Coeff c: " + w3 + "<br>";
    
}

function init()
{
    var myCanvas = document.getElementById("myCanvas");
    context = myCanvas.getContext('2d');
    context.clearRect(0,0,600,600);

    randomF();

    
    setInterval(iterate,10); 
}
</script>


<body onload="init()">
<h1>AI, 2x1 Classifier</h1>
<div id="container">
	
<canvas id="myCanvas" width="600" height="600"></canvas>

<div id="text"></div>

<h2>Intro</h2>

This a demo classifies 2 types of points. The points can be separated by a plane.  We are training a neuron to find the plane that divides the set.
  
</br>
</br>
<h2>Contact/Questions:</h2>
 &lt;my_github_account_username&gt;$@gmail.com$.
</br>
</br>
</div>
</body>
</html>
